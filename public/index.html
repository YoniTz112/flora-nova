<!DOCTYPE html>
<html lang="he">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×ª×¤×¨×™×˜ ×”××¡×¢×“×”</title>

<style>
body {
  font-family: 'David Libre', Arial, sans-serif;
  background: #fffaf0;
  direction: rtl;
  margin: 0;
  padding: 0;
  color: #333;
}

header {
  background-color: #1e90ff;
  color: white;
  padding: 20px;
  text-align: center;
  font-size: 2em;
  font-weight: bold;
  box-shadow: 0 2px 6px rgba(0,0,0,0.2);
}

.container {
  padding: 20px;
  max-width: 600px;
  margin: auto;
  padding-bottom: 120px;
}

h2 {
  color: #1e90ff;
  margin-top: 25px;
  border-bottom: 2px solid #1e90ff;
  padding-bottom: 5px;
}

.item, .drink-container {
  margin-bottom: 15px;
  border-radius: 10px;
  background: #fff;
  padding: 10px 15px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

label {
  display: block;
  margin-bottom: 5px;
  font-size: 1.1em;
}

input[type="number"], input[type="text"] {
  padding: 5px;
  width: 60px;
  font-size: 1em;
  margin-left: 5px;
  border-radius: 5px;
  border: 1px solid #ccc;
}

button {
  background-color: #ffcc00;
  border: none;
  padding: 7px 12px;
  font-size: 1em;
  cursor: pointer;
  margin-top: 5px;
  border-radius: 5px;
  transition: 0.3s;
}

button:hover {
  background-color: #e6b800;
}

.toppings {
  margin-top: 5px;
  margin-bottom: 10px;
}

/* BotÃ£o do carrinho */
#cartToggle {
  position: fixed;
  top: 50%;
  right: 0;
  transform: translateY(-50%);
  background-color: #ff6600;
  color: white;
  padding: 15px 20px;
  cursor: pointer;
  border-radius: 5px 0 0 5px;
  z-index: 200;
  font-weight: bold;
  font-size: 1.2em;
  box-shadow: 0 0 10px rgba(0,0,0,0.3);
}

/* Carrinho lateral */
.cart {
  background-color: #f8f1d1;
  padding: 10px;
  font-weight: bold;
  white-space: pre-line;
  position: fixed;
  top: 0;
  right: -320px; /* escondido inicialmente */
  width: 320px;
  height: 100%;
  box-shadow: -2px 0 6px rgba(0,0,0,0.2);
  transition: right 0.3s ease;
  z-index: 150;
  overflow-y: auto;
}

.cart.open {
  right: 0;
}

.cart-item button {
  background-color: red;
  color: white;
  padding: 0 5px;
  font-size: 0.9em;
  border-radius: 3px;
  cursor: pointer;
}

input[type="checkbox"] {
  margin-left: 5px;
}

/* Aviso apÃ³s envio */
#orderMessage {
  display:none;
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:rgba(0,0,0,0.8);
  color:white;
  justify-content:center;
  align-items:center;
  font-size:2em;
  text-align:center;
  z-index:300;
  padding:20px;
  box-sizing:border-box;
  flex-direction:column;
}
#orderMessage button {
  margin-top:20px;
  padding:10px 20px;
  font-size:1em;
  cursor:pointer;
  background:#ffcc00;
  border:none;
  border-radius:5px;
  color:#000;
}
</style>
</head>

<body>

<header>×ª×¤×¨×™×˜ ×”××˜×‘×— ×”×™×©×¨××œ×™ ×‘×™×ª ×—×‘×´×“ ×¤×œ×•×¨×”</header>

<div class="container">

<label for="customerName">×©×:</label>
<input type="text" id="customerName" placeholder="×”×›× ×¡ ×©×" required>

<h2>×× ×•×ª ×¢×™×§×¨×™×•×ª</h2>

<div class="item">
  <label>×©× ×™×¦×œ ×‘×‘×’×˜ â€“ 70â‚ª</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡
    <input type="checkbox" class="topping" data-name="×—×¨×™×£" data-price="0"> ×—×¨×™×£
    <input type="checkbox" class="topping" data-name="×¡×œ×˜ ×™×©×¨××œ×™" data-price="0"> ×¡×œ×˜ ×™×©×¨××œ×™
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×™×¨×•×§" data-price="0"> ×›×¨×•×‘ ×™×¨×•×§
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×¡×’×•×œ" data-price="0"> ×›×¨×•×‘ ×¡×’×•×œ
    <input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="10"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+10â‚ª)
  </div>
  <button onclick="addToCart(this, 70, '×©× ×™×¦×œ ×‘×‘×’×˜')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="item">
  <label>×©×•×•××¨××” ×‘×‘×’×˜ â€“ 70â‚ª</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡
    <input type="checkbox" class="topping" data-name="×—×¨×™×£" data-price="0"> ×—×¨×™×£
    <input type="checkbox" class="topping" data-name="×¡×œ×˜ ×™×©×¨××œ×™" data-price="0"> ×¡×œ×˜ ×™×©×¨××œ×™
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×™×¨×•×§" data-price="0"> ×›×¨×•×‘ ×™×¨×•×§
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×¡×’×•×œ" data-price="0"> ×›×¨×•×‘ ×¡×’×•×œ
    <input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="10"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+10â‚ª)
  </div>
  <button onclick="addToCart(this, 70, '×©×•×•××¨××” ×‘×‘×’×˜')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="item">
  <label>×—×–×” ×¢×•×£ ×‘×‘×’×˜ â€“ 70â‚ª</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡
    <input type="checkbox" class="topping" data-name="×—×¨×™×£" data-price="0"> ×—×¨×™×£
    <input type="checkbox" class="topping" data-name="×¡×œ×˜ ×™×©×¨××œ×™" data-price="0"> ×¡×œ×˜ ×™×©×¨××œ×™
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×™×¨×•×§" data-price="0"> ×›×¨×•×‘ ×™×¨×•×§
    <input type="checkbox" class="topping" data-name="×›×¨×•×‘ ×¡×’×•×œ" data-price="0"> ×›×¨×•×‘ ×¡×’×•×œ
    <input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="10"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+10â‚ª)
  </div>
  <button onclick="addToCart(this, 70, '×—×–×” ×¢×•×£ ×‘×‘×’×˜')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="item">
  <label>×”××‘×•×¨×’×¨ â€“ 60â‚ª</label>
  <div class="toppings">
    <label>×ª×•×¡×¤×•×ª:</label>
    <input type="checkbox" class="topping" data-name="×—×•××•×¡" data-price="0"> ×—×•××•×¡
    <input type="checkbox" class="topping" data-name="××™×•× ×–" data-price="0"> ××™×•× ×–
    <input type="checkbox" class="topping" data-name="×§×˜×©×•×¤" data-price="0"> ×§×˜×©×•×¤
    <input type="checkbox" class="topping" data-name="×¢×’×‘× ×™×”" data-price="0"> ×¢×’×‘× ×™×”
    <input type="checkbox" class="topping" data-name="×‘×¦×œ" data-price="0"> ×‘×¦×œ
    <input type="checkbox" class="topping" data-name="×—×¡×”" data-price="0"> ×—×¡×”
    <input type="checkbox" class="topping" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="10"> ×¦â€™×™×¤×¡ ×‘×¦×“ (+10â‚ª)
    <input type="checkbox" class="topping" data-name="×ª×•×¡×¤×ª ×§×¦×™×¦×”" data-price="10"> ×ª×•×¡×¤×ª ×§×¦×™×¦×” (+10â‚ª)
  </div>
  <button onclick="addToCart(this, 60, '×”××‘×•×¨×’×¨')">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<h2>×¦â€™×™×¤×¡ ×‘×¦×“ â€“ 10â‚ª (×× ×” × ×¤×¨×“×ª)</h2>
<div class="drink-container">
  <label>×¦â€™×™×¤×¡ ×‘×¦×“</label>
  <input type="number" min="0" value="0" class="drink-input" data-name="×¦â€™×™×¤×¡ ×‘×¦×“" data-price="10">
  <button onclick="addItemFromInput(this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<h2>×©×ª×™×™×” â€“ 7â‚ª</h2>

<div class="drink-container">
  <label>×§×•×§×” ×§×•×œ×”</label>
  <input type="number" min="0" value="0" class="drink-input" data-name="×§×•×§×” ×§×•×œ×”" data-price="7">
  <button onclick="addItemFromInput(this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="drink-container">
  <label>×§×•×œ×” ×–×™×¨×•</label>
  <input type="number" min="0" value="0" class="drink-input" data-name="×§×•×œ×” ×–×™×¨×•" data-price="7">
  <button onclick="addItemFromInput(this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="drink-container">
  <label>××™×</label>
  <input type="number" min="0" value="0" class="drink-input" data-name="××™×" data-price="7">
  <button onclick="addItemFromInput(this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

<div class="drink-container">
  <label>××™× ××•×’×–×™×</label>
  <input type="number" min="0" value="0" class="drink-input" data-name="××™× ××•×’×–×™×" data-price="7">
  <button onclick="addItemFromInput(this)">×”×•×¡×£ ×œ×¢×’×œ×”</button>
</div>

</div>

<!-- BotÃ£o do carrinho -->
<div id="cartToggle" onclick="toggleCart()">×¢×’×œ×” ğŸ›’</div>

<!-- Carrinho lateral -->
<div id="cart" class="cart">
  ×”×¢×’×œ×” ×¨×™×§×”
  <button style="float:left;" onclick="sendOrder()">×©×œ×— ×”×–×× ×”</button>
</div>

<!-- Aviso apÃ³s envio -->
<div id="orderMessage">
  ×”×”×–×× ×” × ×©×œ×—×” ×‘×”×¦×œ×—×”!<br>
  ×× × ×—×–×¨×• ×œ-WhatsApp ×›×“×™ ×œ××©×¨ ××ª ×”×”×–×× ×”.
  <button onclick="closeMessage()">×¡×’×•×¨</button>
</div>

<script>
let cart = [];

function addToCart(btn, price, name){
  const parent = btn.parentElement;
  const toppings = [...parent.querySelectorAll('.topping:checked')].map(t=>t.dataset.name);
  const toppingsPrice = [...parent.querySelectorAll('.topping:checked')]
        .reduce((sum,t)=>sum + parseInt(t.dataset.price),0);
  parent.querySelectorAll('.topping:checked').forEach(t=> t.checked = false);
  cart.push({ name, price, toppings, toppingsPrice, type:"food" });
  updateCart();
}

function addItemFromInput(btn){
  const parent = btn.parentElement;
  const input = parent.querySelector('input');
  const qty = parseInt(input.value);
  const name = input.dataset.name;
  const price = parseInt(input.dataset.price);
  for(let i=0;i<qty;i++){
    cart.push({ name, price, toppings: [], toppingsPrice: 0, type: "drink" });
  }
  input.value = 0;
  updateCart();
}

function removeFromCart(idx){
  cart.splice(idx,1);
  updateCart();
}

function updateCart(){
  const cartDiv = document.getElementById("cart");
  if(cart.length === 0){
    cartDiv.innerHTML = `×”×¢×’×œ×” ×¨×™×§×” <button style="float:left;" onclick="sendOrder()">×©×œ×— ×”×–×× ×”</button>`;
    return;
  }

  const itemsHtml = cart.map((item,i)=>
    `${i+1}. ${item.name}${item.toppings.length ? ' (' + item.toppings.join(', ') + ')' : ''} - â‚ª${item.price + item.toppingsPrice} <button onclick="removeFromCart(${i})">X</button>\n`
  ).join("");

  const total = cart.reduce((sum,item)=>sum + item.price + item.toppingsPrice, 0);

  cartDiv.innerHTML = itemsHtml + 
    `<p style="font-weight:bold; margin-top:10px;">×¡×”"×›: â‚ª${total}</p>` +
    `<button style="float:left;" onclick="sendOrder()">×©×œ×— ×”×–×× ×”</button>`;
}


function toggleCart(){
  document.getElementById('cart').classList.toggle('open');
}

async function sendOrder(){
  const name = document.getElementById('customerName').value.trim();
  if(!name){ alert("×× × ×”×›× ×¡ ×©×"); return; }
  if(cart.length < 1){ alert("×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×× ×” ××—×ª"); return; }

  const items = cart.filter(i => i.type === 'food');
  const drinks = cart.filter(i => i.type === 'drink');
  const total = items.reduce((sum,i)=>sum+i.price+i.toppingsPrice,0)
              + drinks.reduce((sum,i)=>sum+i.price,0);
  const order = { name, items, drinks, total };

  try {
await fetch("/orders", {
  method: "POST",
  headers: { "Content-Type": "application/json" },
  body: JSON.stringify(order)
});

    cart = [];
    updateCart();
    document.getElementById('customerName').value = '';

    // Mostra mensagem grande APENAS apÃ³s clicar em enviar
    document.getElementById('orderMessage').style.display = 'flex';

  } catch(err){
    alert("Erro ao enviar o pedido! Verifique se o servidor estÃ¡ rodando.");
    console.log(err);
  }
}

function closeMessage(){
  document.getElementById('orderMessage').style.display = 'none';
}
</script>

</body>
</html>
